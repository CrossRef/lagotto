<div class="search-wide">
  <%= form_tag(relations_path, :method => "get", :class => "form form-horizontal", :role => "form") do %>
    <div class="input-group">
      <%= search_field_tag :q, params[:q], :placeholder => "Search by DOI", :class => "form-control" %>
      <div class="input-group-btn">
        <button type="submit" class="btn btn-primary hidden-xs"><%= icon("search") %></button>
      </div>
    </div>
  <% end %>
</div>

<div class="row">
  <div class="col-md-9" id="content">
    <div class="text-muted loading" id="loading-results">Loading â€¦ <%= image_tag "spinner.gif" %></div>
  </div>
  <div class='col-md-3'>
    <% if Source.for_relations.size > 0 %>
      <div class="panel facets">
        <div class="panel-body">
          <h4>Sources</h4>
          <ul>
            <% if @source.present? %>
              <li class="active">
                <%= link_to icon('check-square-o').html_safe, relations_path(q: params[:q], relation_type_id: params[:relation_type_id]) %>
                <%= @source.title %>
              </li>
            <% else %>
              <% Source.for_relations.each do |source| %>
                <li>
                  <%= link_to icon('square-o').html_safe, relations_path(q: params[:q], relation_type_id: params[:relation_type_id], source_id: source.name) %>
                  <%= source.title %>
                </li>
              <% end %>
            <% end %>
          </ul>
        </div>
      </div>
    <% end %>
    <% if RelationType.all.size > 0 %>
      <div class="panel facets">
        <div class="panel-body">
          <h4>Relation types</h4>
          <ul>
            <% if @relation_type.present? %>
              <li class="active">
                <%= link_to icon('check-square-o').html_safe, relations_path(q: params[:q], source_id: params[:source_id]) %>
                <%= @relation_type.title %>
              </li>
            <% else %>
              <% RelationType.order("name").each do |relation_type| %>
                <li>
                  <%= link_to icon('square-o').html_safe, relations_path(q: params[:q], relation_type_id: relation_type.name, source_id: params[:source_id]) %>
                  <%= relation_type.title %>
                </li>
              <% end %>
            <% end %>
          </ul>
        </div>
      </div>
    <% end %>
  </div>
</div>

<%= javascript_include_tag 'relations/index' %>
